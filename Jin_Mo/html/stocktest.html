<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock search</title>
</head>
<body>

    <div id="app">
        {{ stockData }}
        <br>
        {{ jsonData }}
        <hr>
        <button @click="replaceData()">replaceData</button>
        <button @click="toJSON()">toJSON</button>
    </div>

    <script src="https://unpkg.com/vue@2.6.11/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>

        axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';
        axios.defaults.headers.common['Content-Type'] = 'application/x-www-form-urlencoded';

        new Vue({
            el: '#app',
            data: {
                jsonData: null,
                stockData: '{"req":{"stock_index_arys":"[\"0050\",\"2002\"]"},"earn_values":{"0050":"{\"2011\": {\"cash\": 1.95, \"year\": \"2011\", \"count\": 1.95, \"stock\": 0}, \"2012\": {\"cash\": 1.85, \"year\": \"2012\", \"count\": 1.85, \"stock\": 0}, \"2013\": {\"cash\": 1.35, \"year\": \"2013\", \"count\": 1.35, \"stock\": 0}, \"2014\": {\"cash\": 1.55, \"year\": \"2014\", \"count\": 1.55, \"stock\": 0}, \"2015\": {\"cash\": 2, \"year\": \"2015\", \"count\": 2, \"stock\": 0}, \"2016\": {\"cash\": 0.85, \"year\": \"2016\", \"count\": 0.85, \"stock\": 0}, \"2017\": {\"cash\": 2.4, \"year\": \"2017\", \"count\": 2.4, \"stock\": 0}, \"2018\": {\"cash\": 2.9, \"year\": \"2018\", \"count\": 2.9, \"stock\": 0}, \"2019\": {\"cash\": 2.3, \"year\": \"2019\", \"count\": 2.3, \"stock\": 0}}","2002":"{\"2011\": {\"cash\": 1.99, \"year\": \"2011\", \"count\": 3.2375, \"stock\": 0.5}, \"2012\": {\"cash\": 1.01, \"year\": \"2012\", \"count\": 1.38425, \"stock\": 0.15}, \"2013\": {\"cash\": 0.4, \"year\": \"2013\", \"count\": 0.6495, \"stock\": 0.1}, \"2014\": {\"cash\": 0.7, \"year\": \"2014\", \"count\": 1.1989999999999998, \"stock\": 0.2}, \"2015\": {\"cash\": 1, \"year\": \"2015\", \"count\": 1, \"stock\": 0}, \"2016\": {\"cash\": 0.5, \"year\": \"2016\", \"count\": 0.5, \"stock\": 0}, \"2017\": {\"cash\": 0.85, \"year\": \"2017\", \"count\": 0.85, \"stock\": 0}, \"2018\": {\"cash\": 0.88, \"year\": \"2018\", \"count\": 0.88, \"stock\": 0}, \"2019\": {\"cash\": 1, \"year\": \"2019\", \"count\": 1, \"stock\": 0}}"}}'
            },
            mounted() {
                // this.getStockDataXHR();
                // this.getStockData();
            },
            methods: {
                replaceData() {
                    this.stockData = this.stockData.replace(/\:\"\[/, '\:\[');
                    this.stockData = this.stockData.replace(/\"\]\"/, '\"\]');
                    this.stockData = this.stockData.replace(/\:\"\{/g, '\:\{');
                    this.stockData = this.stockData.replace(/\}\}\"/g, '\}\}');
                    console.log(this.stockData);
                },
                toJSON() {
                    this.jsonData = JSON.parse(this.stockData);
                    console.log(this.jsonData);
                    console.log(this.jsonData.req);
                    console.log(this.jsonData.earn_values['0050']['2011']);
                },
                getStockData() {
                    axios.get('http://trading.maxosoft.com/api/tw_stock_earn_values?stock_index_arys=[%220050%22,%222002%22]', {
                        // ...
                    })
                    .then((response) => {
                        console.log(response);
                    })
                    .catch((err) => {
                        console.log(err);
                    })
                },
                getStockDataXHR() {
                    var xhr = new XMLHttpRequest();
                    xhr.open('GET', 'http://trading.maxosoft.com/api/tw_stock_earn_values?stock_index_arys=[%220050%22,%222002%22]');
                    xhr.onload = () => {
                        if (xhr.status >= 200 && xhr.status <= 400) {
                            console.log(xhr.responseText);
                        }
                    }
                    xhr.send();
                }
            }
        });
    </script>
</body>
</html>